"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function t(e,o,n){function c(i,s){if(!o[i]){if(!e[i]){var u="function"==typeof require&&require;if(!s&&u)return u(i,!0);if(r)return r(i,!0);throw new Error("Cannot find module '"+i+"'")}var a=o[i]={exports:{}};e[i][0].call(a.exports,function(t){var o=e[i][1][t];return c(o?o:t)},a,a.exports,t,e,o,n)}return o[i].exports}for(var r="function"==typeof require&&require,i=0;i<n.length;i++)c(n[i]);return c}({1:[function(t,e,o){function n(t,e,o,n){console.log(o),$.ajax({type:"POST",url:t+"/"+e,contentType:"application/json; charset=utf-8",data:JSON.stringify({profile:o}),success:function(t){console.log(t),console.log("register success")},error:function(t,e){console.log(t),console.log(e),console.log("register failed")},complete:function(){"function"==typeof n&&n()},dataType:"text"})}function c(t,e,o){$.ajax({type:"DELETE",url:t+"/"+e,success:function(t){console.log(t),console.log("Detach success")},error:function(t,e){console.log(t),console.log(e),console.log("Detach failed")},complete:function(){"function"==typeof o&&o()},dataType:"text"})}function r(t,e,o,n,c){$.ajax({type:"PUT",url:t+"/"+e+"/"+o,contentType:"application/json; charset=utf-8",data:JSON.stringify({data:n}),success:function(t){console.log(t),console.log("Update success")},error:function(t,e){console.log(t),console.log(e),console.log("Update failed")},complete:function(){"function"==typeof c&&c()},dataType:"text"})}function i(t,e,o,n){var c=0;$.ajax({type:"GET",cache:!1,url:t+"/"+e+"/"+o,success:function(t){c=JSON.parse(t),c="object"===("undefined"==typeof c?"undefined":_typeof(c))&&c.samples&&c.samples[0]&&c.samples[0][1]?c.samples[0][1]:[],console.log(t),console.log("Get success")},error:function(t,e){console.log(t),console.log(e),console.log("Get failed")},complete:function(){"function"==typeof n&&n(c)},dataType:"text"})}function s(t,e){console.log(t+"/tree");var o="";$.ajax({method:"GET",cache:!1,url:t+"/tree",success:function(t){try{t=JSON.parse(t)}catch(e){return}for(var n=0;++n<1e4&&t["SX_"+n];);o="SX_"+n,console.log(o)},error:function(t,e){console.log(t),console.log(e),console.log("Get device name failed")},complete:function(){"function"==typeof e&&e(o)},dataType:"text"})}window&&(window.IoTtalk={register:n,detach:c,update:r,get:i,getDeviceName:s}),e.exports={register:n,detach:c,update:r,get:i,getDeviceName:s}},{}],2:[function(t,e,o){var n={_getStatus:function(){return{status:2,msg:"Ready"}}},c={blocks:[]},r=0;e.exports={add:function(t,e,o){n[r.toString()]=t,c.blocks.push([e,o,r.toString()]);for(var i=c.blocks.length-1,s=3;s<arguments.length;++s)c.blocks[i].push(arguments[s]);++r},ext:n,descriptor:c}},{}],3:[function(t,e,o){!function(e){function o(){S&&g&&g.ScratchX_input&&(S=!1,l.update(p,d,"ScratchX_input",[g.ScratchX_input])),setTimeout(o,_)}function n(t,e){e(g&&"ScratchX_output"in g?"object"===_typeof(g.ScratchX_output)?"undefined"!=typeof g.ScratchX_output[parseInt(t,10)]?g.ScratchX_output[parseInt(t,10)]:"undefined"!=typeof g.ScratchX_output[t.toString()]?g.ScratchX_output[t.toString()]:0:g.ScratchX_output:"not exist")}function c(t,e){""===p&&""===d?(p="http://"+t+":9999",l.getDeviceName(p,function(t){d=t,g={profile:{d_name:d,dm_name:"ScratchX",is_sim:!1,df_list:["ScratchX_input","ScratchX_output"]},ScratchX_input:{},ScratchX_output:"nothing from server"},l.register(p,d,g.profile,e)})):e()}function r(){return d}function i(t){""!==p?(l.detach(p,d,t),p="",d="",d_name="",g=null):"function"==typeof t&&t()}function s(t,e,o){e=e.toString(),g&&g.ScratchX_input?(g.ScratchX_input[t]=e,S=!0,o()):o("Please register first")}function u(t,e,o){e=Number(e)||0,g&&g.ScratchX_input?(g.ScratchX_input[t]=e,S=!0,o()):o("Please register first")}function a(t,e){if(""===p)return void e("Please register first");if(Date.now()-h<=y)n(t,e);else{h=Date.now();try{l.get(p,d,"ScratchX_output",function(o){g.ScratchX_output=o[0],n(t,e)})}catch(o){e("js bug, plase report issue")}}}var l=t("__iottalk_api.js"),f=t("__scratchX-register.js"),p="",d="",g=null,y=200,h=Date.now(),_=200,S=!1;setTimeout(o,2e3),f.add(c,"w","set IoTtalk server url %s","ip"),f.add(r,"r","my device name"),f.add(s,"w","update %s = %s","key","val"),f.add(u,"w","update %s = %d","key","0"),f.add(a,"R","get %s","key"),ScratchExtensions.register("IoTtalk extension",f.descriptor,f.ext),window.onunload=i,window.onbeforeunload=i,window.onclose=i,window.onpagehide=i}({})},{"__iottalk_api.js":1,"__scratchX-register.js":2}]},{},[3]);